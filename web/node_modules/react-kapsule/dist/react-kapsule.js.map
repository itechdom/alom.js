{"version":3,"file":"react-kapsule.js","sources":["../src/index.js"],"sourcesContent":["import React from 'react';\n\nexport default function(kapsuleComponent, wrapperElType = 'div', bindMethodNames = [], initProps = []) {\n  class FromKapsuleComp extends React.PureComponent {\n    constructor(props) {\n      super(props);\n\n      const configOptions = Object.assign({}, ...initProps\n        .filter(p => props.hasOwnProperty(p))\n        .map(prop => ({ [prop]: props[prop] }))\n      );\n\n      this.state = {\n        comp: kapsuleComponent(configOptions)\n      }\n    }\n\n    // Call a component method\n    _call = (method, ...args) =>\n      this.state.comp[method] instanceof Function\n        ? this.state.comp[method](...args)\n        : undefined; // method not found\n\n    _getDynamicProps = () => {\n      const dynamicProps = Object.assign({}, this.props);\n      initProps.forEach(initProp => delete dynamicProps[initProp]); // initProps should not be called\n      return dynamicProps;\n    };\n\n    componentDidMount() {\n      Object.keys(this._getDynamicProps()).forEach(p => {\n        this._call(p, this.props[p]);\n      });\n      this.state.comp(this.rootElem);\n    }\n\n    componentDidUpdate(prevProps) {\n      Object.keys(this._getDynamicProps()).forEach(p => {\n        if (prevProps[p] !== this.props[p]) {\n          this._call(p, this.props[p]);\n        }\n      });\n    }\n\n    componentWillUnmount() {\n      // Invoke _destructor, if it exists\n      if (this.state.comp._destructor instanceof Function) {\n        this.state.comp._destructor();\n      }\n    }\n\n    render() {\n      return React.createElement(\n        wrapperElType,\n        { ref: elem => { this.rootElem = elem } }\n      );\n    }\n  }\n\n  bindMethodNames.forEach(method => {\n    FromKapsuleComp.prototype[method] = function(...args) {\n      return this._call(method, ...args);\n    }\n  });\n\n  return FromKapsuleComp;\n}\n"],"names":["kapsuleComponent","wrapperElType","bindMethodNames","initProps","FromKapsuleComp","props","method","args","state","comp","Function","undefined","dynamicProps","Object","assign","forEach","initProp","configOptions","filter","p","hasOwnProperty","map","prop","keys","_getDynamicProps","_call","rootElem","prevProps","_destructor","React","createElement","ref","elem","PureComponent","prototype"],"mappings":"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"}